/*!
 * `rbroker` JavaScript Client Library v8.0.0
 * http://go.microsoft.com/fwlink/?LinkID=698842
 *
 * Copyright (C) 2010-2016, Microsoft Corporation
 * Released under the Apache License 2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Includes:
 *   - superagent: https://github.com/visionmedia/superagent
 *   - ws: https://github.com/einaros/ws
 *   - D.js: http://malko.github.io/D.js
 *   - yui-lang.js: https://github.com/yui/yui3 (DeployR port)
 *
 * superagent
 *
 * Copyright (c) 2014-2015 TJ Holowaychuk <tj@vision-media.ca>
 * Open Source Initiative OSI - The MIT License
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the,
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * ws
 *
 * Copyright (c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * Open Source Initiative OSI - The MIT License
 *
 * Permission is hereby granted, free of charge, to any person obtaining 
 * a copy of this software and associated documentation files 
 * (the "Software"), to deal in the Software without restriction, 
 * including without limitation the rights to use, copy, modify, merge
 * publish, distribute, sublicense, and/or sell copies of the Software, 
 * and to permit persons to whom the Software is furnished to do so, 
 * subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be 
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, 
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF 
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
 * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY 
 * CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, 
 * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE 
 * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * D
 *
 * Copyright (C) 2013 Jonathan Gotti <jgotti at jgotti dot net>
 * Open Source Initiative OSI - The MIT License
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the,
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * selfish
 *
 * Copyright 2011 Irakli Gozalishvili. All rights reserved
 * Open Source Initiative OSI - The MIT License
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the,
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * yui-lang
 *
 * The lang component is a DeployR port of yui-lang.js by Yahoo!
 *
 * Software License Agreement (BSD License)
 * Copyright (c) 2013, Yahoo! Inc. All rights reserved.
 *
 * Redistribution and use of this software in source and binary forms, 
 * with or without modification, are permitted provided that the 
 * following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the following disclaimer. Redistributions
 * in binary form must reproduce the above copyright notice, this list of
 * conditions and  the following disclaimer in the documentation and/or 
 * other materials provided with the distribution.
 * 
 * Neither the name of Yahoo! Inc. nor the names of YUI's contributors 
 * may be used to endorse or promote products derived from this software 
 * without specific prior written permission of Yahoo! Inc.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT 
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR 
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT 
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT 
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, 
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY 
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT, 
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE 
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * Date: 2016-06-29
 */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.rbroker=t()}}(function(){var t;return function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[s]={exports:{}};t[s][0].call(l.exports,function(e){var r=t[s][1][e];return i(r?r:e)},l,l.exports,e,t,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,r){var n=t("merge"),i=t("./rbroker-engine"),o=t("../worker/background-task-worker");e.exports=i.extend({initialize:function(t){var e=10;i.initialize.call(this,n(t,{maxConcurrentTaskLimit:e}));for(var r=0;r<this.parallelTaskLimit;r++)this.resourceTokenPool.offer(r);this.ruser=this.validateEndpoint().io("/r/user/login").data(t.credentials).ctx(this).end(function(t){this.emit("ready")})},refresh:function(t){throw new Error("BackgroundTaskBroker refresh not supported.")},shutdown:function(){return this.flush(),this.ruser.release()},createWorker:function(t){return o["new"](t,this.ruser)}})},{"../worker/background-task-worker":12,"./rbroker-engine":4,merge:39}],2:[function(t,e,r){var n=t("d.js"),i=t("./rbroker-engine"),o=t("../worker/discrete-task-worker");e.exports=i.extend({initialize:function(t){i.initialize.call(this,t);for(var e=0;e<this.parallelTaskLimit;e++)this.resourceTokenPool.offer(e);t.credentials?this.ruser=this.validateEndpoint().io("/r/user/login").data(t.credentials).ctx(this).end(function(t){this.emit("ready")}):this.validateEndpoint(function(){this.ruser=null,this.emit("ready")})},refresh:function(t){throw new Error("DiscreteTaskBroker refresh not supported.")},createWorker:function(t){return o["new"](t,this.ruser)},shutdown:function(){return this.flush(),this.ruser?this.ruser.release():n.promisify(!0)}})},{"../worker/discrete-task-worker":13,"./rbroker-engine":4,"d.js":18}],3:[function(t,e,r){var n=t("deployr"),i=t("d.js"),o=t("merge"),s=t("./rbroker-engine"),a=t("../worker/pooled-task-worker");e.exports=s.extend({initialize:function(t){function e(t){var e=t.get("projects");if(e.length>0){var n=t.get("error");n&&r.emit("warning",n),e.forEach(function(t){r.resourceTokenPool.offer(t.project)}),r.parallelTaskLimit=r.resourceTokenPool.size(),r.httpKeepAlive.start(r.ruser),r.emit("ready")}else r.emit("error",t.get("error"))}if(s.initialize.call(this,t),!t.credentials)throw new Error("Broker failed to initialize, user credentials required.");var r=this,i=this.parallelTaskLimit,a=o({poolsize:i},t.pool||{});this.httpKeepAlive={id:null,PING_INTERVAL:6e4,start:function(t){this.stop(),this.id=setInterval(function(){n.io("/r/user/about").share(t.getCookies()).end()},this.PING_INTERVAL)},stop:function(){clearInterval(this.id)}},this.ruser=this.validateEndpoint().io("/r/user/login").data(t.credentials).ctx(this).end(function(){t.releaseGridResources?this.ruser.io("/r/user/release").end().io("/r/project/pool").data(a).end(e):this.ruser.io("/r/project/pool").data(a).end(e)})},refresh:function(t){var e=[],r={},s=this.ruser;return this.isIdle()?(t=t||{},r={code:"# Refresh project on PooledTaskBroker.",preloadfilename:t.preloadfilename,preloaddirectory:t.preloaddirectory,preloadfileauthor:t.preloadfileauthor,preloadfileversion:t.preloadfileversion},this.resourceTokenPool.q.forEach(function(t){e.push(n.io("/r/project/recycle").share(s.getCookies()).delay().data({project:t}).end().io("/r/project/execute/code").share(s.getCookies()).delay().data(o(r,{project:t})).end())}),n.pipeline(e)):i.rejected(new Error("RBroker is not idle, refresh not permitted."))},shutdown:function(){var t=this.resourceTokenPool.q.slice();return this.resourceTokenPool.q=[],this.httpKeepAlive.stop(),this.flush(),this.ruser.release(t)},createWorker:function(t){return a["new"](t,this.ruser)}})},{"../worker/pooled-task-worker":14,"./rbroker-engine":4,"d.js":18,deployr:20,merge:39}],4:[function(t,e,r){var n=t("deployr"),i=t("merge"),o=t("selfish").Base,s=t("deployr/lib/emitter"),a=t("../rtask-token"),u=t("../util/rtask-queue"),c=999;e.exports=o.extend(s,{initialize:function(t){s.initialize.call(this);var e=this;this.config=t,this.scope=this.config.ctx||this,this.engineStarted=!1,this.parallelTaskLimit=this.config.maxConcurrentTaskLimit||1,this.pendingLow=u["new"](c),this.pendingHigh=u["new"](c),this.resourceTokenPool=u["new"](c),n.configure({host:t.host,cors:t.cors,logging:t.logging,allowSelfSignedSSLCert:t.allowSelfSignedSSLCert,events:{error:function(t,e){this.emit("error",e)}.bind(this)}}),this.runtime={runningTasks:0,totals:{success:0,failure:0},stats:function(t){return{maxConcurrency:e.maxConcurrency(),totalTasksRun:this.totals.success+this.totals.failure,totalTasksRunToSuccess:this.totals.success,totalTasksRunToFailure:this.totals.failure,totalTimeTasksOnCode:t.result.timeOnCode,totalTimeTasksOnServer:t.result.timeOnServer,totalTimeTasksOnCall:t.result.timeOnCall,task:t.task}},calibrate:function(t){return this.runningTasks=this.runningTasks+t,this.runningTasks<0&&(this.runningTasks=0),this.runningTasks}},this.on("ready",function(){this.engineStarted=!0;for(var t=0;t<this.parallelTaskLimit&&!this.isIdle();t++)this.run()})},validateEndpoint:function(t){return n.io("/r/server/info").ctx(this).timeout(1e4).end(t)},owner:function(){return this.ruser},simulateApp:function(t){if(t){if("function"!=typeof t.simulateApp)throw new Error('ReferenceError: "simulateApp" is not defined');t.simulateApp(this)}},submit:function(t,e){var r=this.createWorker(t),n=a["new"](r);return e?this.pendingHigh.offer(r):this.pendingLow.offer(r),this.run(),n},maxConcurrency:function(){return this.parallelTaskLimit},flush:function(){return this.pendingHigh.clear(),this.pendingLow.clear(),this.status()},isConnected:function(){var t=this.ruser?this.ruser.io("/r/user/about"):n.io("/r/server/info");return t.global(!1).promise().success(function(){return!0}).error(function(){return!1})},status:function(){var t=this.pendingHigh.size()+this.pendingLow.size(),e=this.parallelTaskLimit-this.runtime.runningTasks,r=this.isIdle();return{pending:t,executing:e,idle:r,toString:function(){return'\nRBrokerStatus: [ pending = "'+t+'" ] [ executing = "'+e+'" ] [ idle = "'+r+'" ]\n'}}},isIdle:function(){return 0===this.runtime.runningTasks&&this.pendingLow.isEmpty()&&this.pendingHigh.isEmpty()},ready:function(t){return this.on("ready",t),this},error:function(t){return this.on("error",t),this},warning:function(t){return this.on("warning",t),this},complete:function(t){return this.on("complete",t),this},idle:function(t){return this.on("idle",t),this},progress:function(t){return this.on("progress",t),this},start:function(t){return this.on("start",t),this},run:function(){var t,e=this;!this.engineStarted||this.resourceTokenPool.isEmpty()||this.pendingLow.isEmpty()&&this.pendingHigh.isEmpty()||(t=this.pendingHigh.take()||this.pendingLow.take(),this.runtime.calibrate(1),this.emit("start",t.task),t.work(this.resourceTokenPool.take()).then(function(t){e.runtime.totals.success++,e.emit("progress",e.runtime.stats(t)),e.emit("complete",t.task,t.result),this.resolve(t)}.bind(t),function(t){var r={task:this.task,result:{id:null,type:this.task.type,success:!1,timeOnCode:0,timeOnServer:0,timeOnCall:0,failure:t}};e.runtime.totals.failure++,e.emit("progress",e.runtime.stats(r)),e.emit("error",i(t,{task:this.task})),e.emit("complete",r.task,r.result),this.reject(i(t,{task:this.task}))}.bind(t)).ensure(function(t){e.runtime.calibrate(-1),e.resourceTokenPool.offer(this.resourceToken),e.run(),e.isIdle()&&e.emit("idle")}.bind(t)))}})},{"../rtask-token":5,"../util/rtask-queue":11,deployr:20,"deployr/lib/emitter":21,merge:39,selfish:40}],5:[function(t,e,r){var n=t("selfish").Base;e.exports=n.extend({initialize:function(t){this.worker=t,this.cancelled=!1},cancel:function(t){return this.cancelled=this.worker.terminate(t),this.cancelled},getTask:function(){return this.worker.task},isDone:function(){return!this.isPending()},isPending:function(){return this.worker.isPending()},isCancelled:function(){return this.cancelled},promise:function(){return this.worker.defer.promise}})},{selfish:40}],6:[function(t,e,r){var n=t("selfish").Base,i=t("enum"),o=new i(["DISCRETE","POOLED","BACKGROUND"],"RTaskType");e.exports=n.extend({DISCRETE:o.DISCRETE,POOLED:o.POOLED,BACKGROUND:o.BACKGROUND})},{"enum":37,selfish:40}],7:[function(t,e,r){var n=t("selfish").Base,i=t("../rtask-type"),o=t("./rtask");e.exports=n.extend(o,{initialize:function(t){o.initialize.call(this,t,i.BACKGROUND)},toString:function(){return"BackgroundTask: "+o.toString.call(this)}})},{"../rtask-type":6,"./rtask":10,selfish:40}],8:[function(t,e,r){var n=t("selfish").Base,i=t("../rtask-type"),o=t("./rtask");e.exports=n.extend(o,{initialize:function(t){o.initialize.call(this,t,i.DISCRETE)},toString:function(){return"DiscreteTask: "+o.toString.call(this)}})},{"../rtask-type":6,"./rtask":10,selfish:40}],9:[function(t,e,r){var n=t("selfish").Base,i=t("../rtask-type"),o=t("./rtask");e.exports=n.extend(o,{initialize:function(t){o.initialize.call(this,t,i.POOLED)},toString:function(){return"PooledTask: "+o.toString.call(this)}})},{"../rtask-type":6,"./rtask":10,selfish:40}],10:[function(t,e,r){var n=t("selfish").Base,i=t("merge");e.exports=n.extend({initialize:function(t,e){this.type=e,this.token=null,t=t||{};for(var r in t)Object.defineProperty(this,r,{value:t[r],enumerable:!0})},serialize:function(){var t={};return Object.keys(this).filter(function(t){return["type","token"].indexOf(t)===-1}).forEach(function(e){t[e]=this[e]}.bind(this)),i(!0,t)},toString:function(){var t="",e=Object.keys(this);for(var r in e)t+=" [ "+e[r]+' = "'+this[e[r]]+'" ]';return t}})},{merge:39,selfish:40}],11:[function(t,e,r){var n=t("selfish").Base,i=n.extend({initialize:function(t){this.capacity=t,this.q=[]},offer:function(t){var e=this.size()<this.capacity;return e&&this.q.push(t),e},take:function(){return this.q.shift()},peek:function(){return this.q[0]},size:function(){return this.q.length},isEmpty:function(){return 0===this.size()},clear:function(){this.q.length=0},iter:function(t){this.q.forEach(t)}});e.exports=i},{selfish:40}],12:[function(t,e,r){var n=(t("selfish").Base,t("deployr")),i=(t("d.js"),t("../rtask-type")),o=t("./rbroker-worker");e.exports=o.extend({initialize:function(t,e){o.initialize.call(this,t),this.ruser=e,this.job=null},work:function(t){var e=this,r=(new Date).getTime(),o=this.task.serialize(),s=o.rinputs||[],a=o.routputs||[];return delete o.rinputs,delete o.routputs,this.resourceToken=t,n.io("/r/job/submit").share(this.ruser.getCookies()).data(o).global(!1).rinputs(s).routputs(a).promise().then(function(t){var n=t.get("job");return e.job=n.job,{task:e.task,result:{id:n.job,type:i.BACKGROUND,timeOnCode:0,timeOnServer:0,timeOnCall:(new Date).getTime()-r,success:!0,failure:null}}})},terminate:function(t){return!(!t||!this.job)&&(this.ruser.io("/r/job/cancel").data({job:this.job}).end(),!0)}})},{"../rtask-type":6,"./rbroker-worker":15,"d.js":18,deployr:20,selfish:40}],13:[function(t,e,r){var n=(t("selfish").Base,t("deployr")),i=(t("d.js"),t("../rtask-type")),o=t("./rbroker-worker");e.exports=o.extend({initialize:function(t,e){o.initialize.call(this,t),this.ruser=e,this.io=null},work:function(t){var e=this.task,r=(new Date).getTime(),o=this.task.serialize(),s=o.rinputs||[],a=o.routputs||[];return delete o.rinputs,delete o.routputs,this.resourceToken=t,this.io=n.io("/r/repository/script/execute").share(this.ruser?this.ruser.getCookies():null).data(o).rinputs(s).routputs(a).global(!1),this.io.promise().then(function(t){t=t.deployr.response;var n=t.execution.timeTotal,o=t.project.project,s=t.execution.console,a=t.execution.results,u=t.execution.artifacts,c=t.workspace.objects,l=t.repository.files;return{task:e,result:{id:o,type:i.DISCRETE,success:!0,timeOnCode:t.execution.timeCode,timeOnServer:n,timeOnCall:(new Date).getTime()-r,failure:null,interrupted:!1,generatedConsole:s,generatedPlots:a,generatedFiles:u,generatedObjects:c,storedFiles:l}}})},terminate:function(t){return!!(t&&this.io&&this.isPending())&&(this.io.abort(),this.io.destroy(),this.io=null,!0)}})},{"../rtask-type":6,"./rbroker-worker":15,"d.js":18,deployr:20,selfish:40}],14:[function(t,e,r){var n=(t("selfish").Base,t("d.js"),t("merge")),i=t("deployr"),o=t("../rtask-type"),s=t("./rbroker-worker");e.exports=s.extend({initialize:function(t,e){s.initialize.call(this,t),this.ruser=e},work:function(t){var e=this.task,r=n({project:t,phantom:!0},this.task.serialize()),s="/r/project/execute/"+(r.code?"code":"script"),a=r.rinputs||[],u=r.routputs||[],c=(new Date).getTime();return delete r.rinputs,delete r.routputs,this.resourceToken=t,i.io(s).share(this.ruser.getCookies()).data(r).rinputs(a).routputs(u).global(!1).promise().then(function(t){t=t.deployr.response;var r=t.execution.console,n=t.execution.results,i=t.execution.artifacts,s=t.workspace.objects,a=t.repository.files;return{task:e,result:{id:t.project.project,type:o.POOLED,success:!0,timeOnCode:t.execution.timeCode,timeOnServer:t.execution.timeTotal,timeOnCall:(new Date).getTime()-c,failure:null,interrupted:!1,generatedConsole:r,generatedPlots:n,generatedFiles:i,generatedObjects:s,storedFiles:a}}})},terminate:function(t){return!!(t&&this.resourceToken&&this.isPending())&&(this.ruser.io("/r/project/execute/interrupt").data({project:this.resourceToken}).end(),!0)}})},{"../rtask-type":6,"./rbroker-worker":15,"d.js":18,deployr:20,merge:39,selfish:40}],15:[function(t,e,r){var n=t("selfish").Base,i=t("d.js");e.exports=n.extend({initialize:function(t){this.task=t,this.defer=i()},work:function(t){},terminate:function(t){},isPending:function(){return this.defer.promise.isPending()},resolve:function(t){this.defer.resolve(t)},reject:function(t){this.defer.reject(t)}})},{"d.js":18,selfish:40}],16:[function(t,e,r){},{}],17:[function(t,e,r){function n(){f&&l&&(f=!1,l.length?h=l.concat(h):p=-1,h.length&&i())}function i(){if(!f){var t=a(n);f=!0;for(var e=h.length;e;){for(l=h,h=[];++p<e;)l&&l[p].run();p=-1,e=h.length}l=null,f=!1,u(t)}}function o(t,e){this.fun=t,this.array=e}function s(){}var a,u,c=e.exports={};!function(){try{a=setTimeout}catch(t){a=function(){throw new Error("setTimeout is not defined")}}try{u=clearTimeout}catch(t){u=function(){throw new Error("clearTimeout is not defined")}}}();var l,h=[],f=!1,p=-1;c.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];h.push(new o(t,e)),1!==h.length||f||a(i,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=s,c.addListener=s,c.once=s,c.off=s,c.removeListener=s,c.removeAllListeners=s,c.emit=s,c.binding=function(t){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(t){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],18:[function(t,e,r){(function(t){!function(r){"use strict";function n(t){h(function(){throw t})}function i(t){return this.then(t,r)}function o(t){return this.then(r,t)}function s(t,e){return this.then(function(e){return f(t)?t.apply(null,p(e)?e:[e]):k.onlyFuncs?e:t},e||r)}function a(t){function e(){t()}return this.then(e,e),this}function u(t){return this.then(function(e){return f(t)?t.apply(null,p(e)?e.splice(0,0,void 0)&&e:[void 0,e]):k.onlyFuncs?e:t},function(e){return t(e)})}function c(t){return this.then(r,t?function(e){throw t(e),e}:n)}function l(t,e){var r=m(t);if(1===r.length&&p(r[0])){if(!r[0].length)return k.fulfilled([]);r=r[0]}var n=[],i=k(),o=r.length;if(o)for(var s=(function(t){r[t]=k.promisify(r[t]),r[t].then(function(s){t in n||(n[t]=e?r[t]:s,--o||i.resolve(n))},function(s){t in n||(e?(n[t]=r[t],--o||i.resolve(n)):i.reject(s))})}),a=0,u=o;a<u;a++)s(a);else i.resolve(n);return i.promise}var h,f=function(t){return"function"==typeof t},p=function(t){return Array.isArray?Array.isArray(t):t instanceof Array},d=function(t){return!(!t||!(typeof t).match(/function|object/))},y=function(t){return t===!1||t===r||null===t},m=function(t,e){return[].slice.call(t,e)},v="undefined",g=typeof TypeError===v?Error:TypeError;if(typeof t!==v&&t.nextTick)h=t.nextTick;else if(typeof MessageChannel!==v){var T=new MessageChannel,R=[];T.port1.onmessage=function(){R.length&&R.shift()()},h=function(t){R.push(t),T.port2.postMessage(0)}}else h=function(t){setTimeout(t,0)};var k=function(t){function e(){if(0!==v){var t,e=T,r=0,n=e.length,i=~v?0:1;for(T=[];r<n;r++)(t=e[r][i])&&t(p)}}function n(t){function r(t){return function(e){return i?void 0:(i=!0,t(e))}}var i=!1;if(v)return this;try{var o=d(t)&&t.then;if(f(o)){if(t===R)throw new g("Promise can't resolve itself");return o.call(t,r(n),r(l)),this}}catch(s){return r(l)(s),this}return m(function(){p=t,v=1,e()}),this}function l(t){return v||m(function(){try{throw t}catch(r){p=r}v=-1,e()}),this}var p,m=(r!==t?t:k.alwaysAsync)?h:function(t){t()},v=0,T=[],R={then:function(t,r){var n=k();return T.push([function(e){try{y(t)?n.resolve(e):n.resolve(f(t)?t(e):k.onlyFuncs?e:t)}catch(r){n.reject(r)}},function(t){if((y(r)||!f(r)&&k.onlyFuncs)&&n.reject(t),r)try{n.resolve(f(r)?r(t):r)}catch(e){n.reject(e)}}]),0!==v&&m(e),n.promise},success:i,error:o,otherwise:o,apply:s,spread:s,ensure:a,nodify:u,rethrow:c,isPending:function(){return!(0!==v)},getStatus:function(){return v}};return R.toSource=R.toString=R.valueOf=function(){return p===r?this:p},{promise:R,resolve:n,fulfill:n,reject:l}};k.deferred=k.defer=k,k.nextTick=h,k.alwaysAsync=!0,k.onlyFuncs=!0,k.resolved=k.fulfilled=function(t){return k(!0).resolve(t).promise},k.rejected=function(t){return k(!0).reject(t).promise},k.wait=function(t){var e=k();return setTimeout(e.resolve,t||0),e.promise},k.delay=function(t,e){var r=k();return setTimeout(function(){try{r.resolve(t.apply(null))}catch(e){r.reject(e)}},e||0),r.promise},k.promisify=function(t){return t&&f(t.then)?t:k.resolved(t)},k.all=function(){return l(arguments,!1)},k.resolveAll=function(){return l(arguments,!0)},k.nodeCapsule=function(t,e){return e||(e=t,t=void 0),function(){var r=k(),n=m(arguments);n.push(function(t,e){t?r.reject(t):r.resolve(arguments.length>2?m(arguments,1):e)});try{e.apply(t,n)}catch(i){r.reject(i)}return r.promise}},typeof window!==v&&(window.D=k),typeof e!==v&&e.exports&&(e.exports=k)}()}).call(this,t("_process"))},{_process:17}],19:[function(t,e,r){e.exports={"/r/user/login":{method:"POST",format:"json"},"/r/user/logout":{method:"POST",format:"json"},"/r/user/about":{method:"POST",format:"json"},"/r/user/autosave":{method:"POST",format:"json"},"/r/user/release":{method:"POST",format:"json"},"/r/project/create":{method:"POST",format:"json"},"/r/project/pool":{method:"POST",format:"json"},"/r/project/recycle":{method:"POST",format:"json"},"/r/project/list":{method:"POST",format:"json"},"/r/project/ping":{method:"POST",format:"json"},"/r/project/about":{method:"POST",format:"json"},"/r/project/about/update":{method:"POST",format:"json"},"/r/project/save":{method:"POST",format:"json"},"/r/project/saveas":{method:"POST",format:"json"},"/r/project/close":{method:"POST",format:"json"},"/r/project/grant":{method:"POST",format:"json"},"/r/project/import":{method:"POST",format:"json",upload:!0},"/r/project/export":{method:"POST",format:"json"},"/r/project/delete":{method:"POST",format:"json"},"/r/project/execute/code":{method:"POST",format:"json"},"/r/project/execute/script":{method:"POST",format:"json"},"/r/project/execute/interrupt":{method:"POST",format:"json"},"/r/project/execute/console":{method:"POST",format:"json"},"/r/project/execute/history":{method:"POST",format:"json"},"/r/project/execute/flush":{method:"POST",format:"json"},"/r/project/execute/result/list":{method:"POST",format:"json"},"/r/project/execute/result/download":{method:"POST",format:"json"},"/r/project/execute/result/delete":{method:"POST",format:"json"},"/r/project/workspace/list":{method:"POST",format:"json"},"/r/project/workspace/get":{method:"POST",format:"json"},"/r/project/workspace/upload":{method:"POST",format:"json",upload:!0},"/r/project/workspace/transfer":{method:"POST",format:"json"},"/r/project/workspace/push":{method:"POST",format:"json"},"/r/project/workspace/save":{method:"POST",format:"json"},"/r/project/workspace/store":{method:"POST",format:"json"},"/r/project/workspace/load":{method:"POST",format:"json"},"/r/project/workspace/delete":{method:"POST",format:"json"},"/r/project/directory/list":{method:"POST",format:"json"},"/r/project/directory/upload":{method:"POST",format:"json",upload:!0},"/r/project/directory/transfer":{method:"POST",format:"json"},"/r/project/directory/write":{method:"POST",format:"json"},"/r/project/directory/update":{method:"POST",format:"json"},"/r/project/directory/store":{method:"POST",format:"json"},"/r/project/directory/load":{method:"POST",format:"json"},"/r/project/directory/download":{method:"POST",format:"json"},"/r/project/directory/delete":{method:"POST",format:"json"},"/r/project/package/list":{method:"POST",format:"json"},"/r/project/package/attach":{method:"POST",format:"json"},"/r/project/package/detach":{method:"POST",format:"json"},"/r/job/list":{method:"POST",format:"json"},"/r/job/submit":{method:"POST",format:"json"},"/r/job/schedule":{method:"POST",format:"json"},"/r/job/query":{method:"POST",format:"json"},"/r/job/cancel":{method:"POST",format:"json"},"/r/job/delete":{method:"POST",format:"json"},"/r/repository/directory/list":{method:"POST",format:"json"},"/r/repository/directory/create":{method:"POST",format:"json"},"/r/repository/directory/rename":{method:"POST",format:"json"},"/r/repository/directory/copy":{method:"POST",format:"json"},"/r/repository/directory/move":{method:"POST",format:"json"},"/r/repository/directory/update":{method:"POST",format:"json"},"/r/repository/script/list":{method:"POST",format:"json"},"/r/repository/script/execute":{method:"POST",format:"json"},"/r/repository/script/render":{method:"GET",format:"json"},"/r/repository/script/interrupt":{method:"POST",format:"json"},"/r/repository/shell/execute":{method:"POST",format:"json"},"/r/repository/directory/archive":{method:"POST",format:"json"},"/r/repository/directory/upload":{method:"POST",format:"json",upload:!0},"/r/repository/directory/download":{method:"POST",format:"json"},"/r/repository/directory/delete":{method:"POST",format:"json"},"/r/repository/file/list":{method:"POST",format:"json"},"/r/repository/file/fetch":{method:"POST",format:"json"},"/r/repository/file/fetch":{method:"POST",format:"json"},"/r/repository/file/upload":{method:"POST",format:"json",upload:!0},"/r/repository/file/transfer":{method:"POST",format:"json"},"/r/repository/file/write":{method:"POST",format:"json"},"/r/repository/file/update":{method:"POST",format:"json"},"/r/repository/file/diff":{method:"POST",format:"json"},"/r/repository/file/revert":{method:"POST",format:"json"},"/r/repository/file/grant":{method:"POST",format:"json"},"/r/repository/file/download":{method:"POST",format:"json"},"/r/repository/file/delete":{method:"POST",format:"json"},"/r/repository/file/copy":{method:"POST",format:"json"},"/r/repository/file/move":{method:"POST",format:"json"},"/r/server/info":{method:"GET",format:"json"}}},{}],20:[function(t,e,r){(function(r){function n(t,e){var r=e.deployr?e.deployr.response.errorCode:e.status,n=this;R.events&&(e.deployr||(e=e.text),n=R.events.ctx||n,R.events.error&&R.events.error.apply(n,[t,e]),R.events[r]&&R.events[r].apply(n,[t,e]))}var i="undefined"!=typeof window,o=t("superagent"),s=t("d.js"),a=t("fs"),u=t("./apis.json"),c=t("./lib/es"),l=t("./lib/utils"),h=t("./lib/lang"),f=t("./lib/logger"),p=t("./lib/queue"),d=t("./lib/emitter"),y=t("./lib/encoder"),m=t("./lib/selfish").Base,v=t("./lib/rinput"),g=t("./lib/rinputs"),T=l.merge;f.setLevel(f.OFF);var R={cors:!1,logging:!1,sticky:!1,cookies:null,host:"",allowSelfSignedSSLCert:!1,maxRequests:null,events:{},set:function(t,e){"set"!==t&&("host"===t&&e&&(e=e.replace(/\/*$|\/*deployr\/*$/,""),e=new RegExp("^(http|https)://","i").test(e)?e:"http://"+e),this[t]=e)}},k=["user","project","workspace","execution","directory","repository","packages"],O=m.extend(d,g,{initialize:function(t,e){d.initialize.call(this,{});var n=R;if(!u[t])throw new Error('Invalid API "'+t+'"');this.api=T({call:t},u[t]),this.link=e||{},this.q=this.link.queue||new p,this.deferred=this.link.deferred||s(),this.cookies=this.link.cookies,this.logger=f.get(t,f.OFF),this.params={},this.inputs=[],this.outputs=[],this.rstream=!1,this.delayed=!1,this.globalEvts=!0,this.file=null,this.entities=null,this.ioFilter=function(){return!0},this.data({format:this.api.format}),this.req=o[this.api.method.toLowerCase()](n.host+"/deployr"+t),this.req.timeout(12e5),i&&R.cors&&this.req.withCredentials(),!i&&R.allowSelfSignedSSLCert&&(r.env.NODE_TLS_REJECT_UNAUTHORIZED="0")},ctx:function(t){return this.scope=t||this,this},global:function(t){return this.globalEvts=h.isBoolean(t)?t:this.globalEvts,this},about:function(){var t=this.req.res;return"/r/user/login"===this.api.call&&t?t.body.get("user"):null},share:function(t){return R.sticky?R.cookies?this.cookies=R.cookies.slice(0):t&&(this.cookies=t.slice(0),R.set("cookies",this.cookies)):this.cookies=t?t.slice(0):this.cookies,this},getCookies:function(){return this.cookies},delay:function(t){return this.delayed=!(!isNaN(parseFloat(t))&&isFinite(t))||t,this},drain:function(){return this.delayed=!1,this.q.flush(),this.deferred.promise},promise:function(){return this.end(),this.deferred.promise},abort:function(){return this.req.abort(),this.emit("abort"),this.deferred.reject(this._handleError({status:"abort",text:"DeployR request aborted."})),this},timeout:function(t){return this.req.timeout(t),this},log:function(t){return this.logger.setLevel(t||f.DEBUG),this},entity:function(t){return this.entities=l.inArray(k,t),this},data:function(t){t=t||{},(t.rinput||t.rinputs)&&(this.rinput(t.rinput),this.rinputs(t.rinputs));var e=["rinput","rinputs","__cookies__"];return e.forEach(function(e){delete t[e]}),this.params=T(this.params,t),this},attach:function(t,e){return this.api.upload&&(this.file=t,e&&this.data({filename:e})),this},stream:function(){return this.rstream=!i&&this.api.upload,this},filter:function(t){return t&&(this.ioFilter=function(e){var r,n={};for(var i in e)"__cookies__"!==i&&(n[i]=e[i]);return r=t(n),!r&&r!==!1||r}),this},ensure:function(t){return this.deferred.promise.ensure(t),this.deferred.promise},error:function(t){return this.on("error",t),this},pipe:function(t){var e=this.q,r=this.api;return e.add(function(n,i,o){if(i)return this.deferred.reject(i),e.flush(n,i,o),void this._clear();this._prepRequest(n,o),f.info("pipe()",r,this.req),this.logger.info("pipe()",r,this.req);var s=this.req.pipe(t);e["yield"](!0),s.on("error",function(){}),s.on("end",function(){}),s.on("data",function(){})},this),e.size()<=1&&e.flush(),t},end:function(t){var e=this,r=this.q,n=this.api,i=null,o=this.entities;return r.add(function(s,a,u){return a?(this.deferred.reject(a),r.flush(s,a,u),void this._clear()):this.ioFilter(u)?(this._prepRequest(s,u),f.info("io()",n,this.req),this.logger.info("io()",n,this.req),this.req.end(function(u){e.share(e.cookies||u.headers["set-cookie"]),e.cookies&&(f.info("cookies",n,e.cookies),e.logger.info("cookies",n,e.cookies)),a=e._handleError(u);var c=u.body&&u.body.deployr?u.body:u;e.inputs=[],e.outputs=[],a||(f.info("end()",n,c,u),e.logger.info("end()",n,c,u),o&&(c=c.deployr.response[o]||c),c.get=function(t){return l.get(c.deployr.response,t)},c.workspace=function(t){return l.workspace(c.deployr.response,t)},t&&(i=t.apply(e.scope,[c,s])),0===r.size()&&(e._clear(),e.deferred.resolve(s||c)),i=T(i,{__cookies__:e.cookies})),r["yield"](!1),r.flush(c,a,i)}),void r["yield"](!0)):(0===r.size()&&this.deferred.resolve(s||u),r.flush(s,a,u),void this._clear())},this,this.delayed),!this.delayed&&r.size()<=1&&r.flush(),this},io:function(t){return O["new"](t,{cookies:this.cookies,queue:this.q,deferred:this.deferred})},script:function(){var t=l.signature(arguments),e=t.opts,r=t.api,n={cookies:this.cookies,queue:this.q,deferred:this.deferred};return t.create?O["new"]("/r/project/create",n).end(function(t){return{project:t.get("project").project}}).io(r).data(e):O["new"](r,n).data(e)},shell:function(t,e){var r={cookies:this.cookies,queue:this.q,deferred:this.deferred},n=h.isString(t)?t.split("/"):[];return n.length>3&&(n=n.slice(1)),O["new"]("/r/repository/shell/execute",r).data({author:n[0],directory:n[1],filename:n[2],args:e})},code:function(t,e){var r={cookies:this.cookies,queue:this.q,deferred:this.deferred},n="/r/project/execute/code";return e?O["new"](n,r).data({code:t,project:e}):O["new"]("/r/project/create",r).end(function(t){return{project:t.get("project").project}}).io(n).data({code:t})},release:function(t,e){function r(t){t===u&&(e?(i.resolve(!0),n.destroy()):O["new"]("/r/user/logout").share(c).error(function(){i.reject(!1)}).end(function(){i.resolve(!0)}).ensure(function(){n.destroy()}))}t=h.isArray(t)?t:[t];var n=this,i=s(),o=!t||!t[0],a=0,u=o?a:t.length-1,c=this.getCookies();return o?r(a):t.forEach(function(t){O["new"]("/r/project/close").data({project:t}).share(c).end().ensure(function(){r(a),a++})}),i.promise},routputs:function(t){return t&&(this.outputs=this.outputs.concat(t)),this},routput:function(t){return t&&this.routputs([t]),this},rinputs:function(t){return t&&(this.inputs=this.inputs.concat(t)),this},rinput:function(t){return t&&this.inputs.push(t),this},destroy:function(){try{this.emit("destroy"),this.offAll();for(var t in this)this.hasOwnProperty(t)&&(this[t]=null,delete this[t])}catch(e){}},_clear:function(){this.params={},this.inputs=[],this.outputs=[],this.rstream=!1,this.delayed=!1,this.api=null,this.file=null,this.entities=null,this.ioFilter=null},_prepRequest:function(t,e){var r=this.req,n=this.file;if(this.api.upload?i||this.req.type("multipart/form-data"):r.type("form"),r.on("error",function(t){t=t||{code:"UNKNOWN CODE",text:"UNKNOWN ERROR"},this._handleError({status:t.code||"UNKNOWN CODE",text:t})}.bind(this)),this.share(e?e.__cookies__:null),e&&this.data(e),this.inputs.length>0&&this.data({inputs:y.encode(this.inputs)}),this.outputs.length>0&&this.data({robjects:this.outputs.join()}),this.cookies&&this.cookies.forEach(function(t){r.set("Cookie",t)}),this.api.upload){for(var o in this.params)r.field(o,this.params[o]||this.params[o]===!1?this.params[o]+"":"");r.attach("file",this.rstream?a.createReadStream(n):n)}else r["GET"===this.api.method?"query":"send"](this.params)},_handleError:function(t){var e=t.status,r=t.body&&t.body.deployr?t.body:t,i=200!==e||r.deployr&&!r.deployr.response.success;return i&&(r={get:function(t){return l.get(this.deployr.response,t)},deployr:{response:{success:!1,call:this.api.call,errorCode:r.deployr?r.deployr.response.errorCode:e,error:r.deployr?r.deployr.response.error:r.text}}},f.error("error()",this.api,r,t),this.logger.error("error()",this.api,r,t),this.globalEvts&&n(this.api.call,r),this.emit("error",r),this.emit("deployr-io:"+r.deployr.response.errorCode,r),this.deferred.reject(r)),i}});e.exports={DeployR:O,apis:function(t){return t?Object.keys(u):u},configure:function(t){t=t||{};for(var e in t)R.set(e,t[e]);return R.sticky||R.set("cookies",null),f.setLevel(R.logging?f.DEBUG:f.OFF),this},io:function(t){return O["new"](t)},auth:function(t,e){var r={username:t,password:e};return O["new"]("/r/user/login").data(r).end()},script:function(){var t=l.signature(arguments),e=t.opts,r=t.api;return t.create?O["new"]("/r/project/create").end(function(t){return{project:t.get("project").project}}).io(r).data(e):O["new"](r).data(e)},pipeline:function(t){function e(){i.add(function(){t.shift().drain().then(function(t){o.push(t),a.push(u),i.isEmpty()&&(r.configure(c),n.resolve({
results:o,errors:a})),i.take()},function(t){o.push(u),a.push(t),i.isEmpty()&&0===o.length&&(r.configure(c),n.reject(a)),i.take()})},null,!0)}var r=this,n=s(),i=new p,o=[],a=[],u=null,c={sticky:R.sticky,cookies:R.cookies};t=t.slice(0),r.configure({sticky:!0});for(var l=0;l<t.length;l++)e();return i.take(),n.promise},es:function(t){var e=t&&t.username&&t.password,r=c["new"](R.host,{"yield":e});if(e){var n=this.auth(t.username,t.password);n.ensure(function(){r.share(n.getCookies()),r.flush()})}return r},RInput:{numeric:function(t,e){return v["new"](t,e).numeric()},integer:function(t,e){return v["new"](t,e).integer()},logical:function(t,e){return v["new"](t,e).logical()},character:function(t,e){return v["new"](t,e).character()},date:function(t,e){return v["new"](t,e).date()},posixct:function(t,e){return v["new"](t,e).posixct()},numericVector:function(t,e){return v["new"](t,e).numericVector()},integerVector:function(t,e){return v["new"](t,e).integerVector()},logicalVector:function(t,e){return v["new"](t,e).logicalVector()},characterVector:function(t,e){return v["new"](t,e).characterVector()},dateVector:function(t,e){return v["new"](t,e).dateVector()},posixctVector:function(t,e){return v["new"](t,e).posixctVector()},list:function(t,e){return v["new"](t,e).list()},dataframe:function(t,e){return v["new"](t,e).dataframe()},factor:function(t,e,r,n){var i={levels:r,labels:n};return v["new"](t,e,i).factor()},ordered:function(t,e,r,n){var i={levels:r,labels:n};return v["new"](t,e,i).ordered()},numericMatrix:function(t,e){return v["new"](t,e).numericMatrix()},integerMatrix:function(t,e){return v["new"](t,e).integerMatrix()},logicalMatrix:function(t,e){return v["new"](t,e).logicalMatrix()},characterMatrix:function(t,e){return v["new"](t,e).characterMatrix()}}}}).call(this,t("_process"))},{"./apis.json":19,"./lib/emitter":21,"./lib/encoder":22,"./lib/es":23,"./lib/lang":24,"./lib/logger":25,"./lib/queue":27,"./lib/rinput":28,"./lib/rinputs":29,"./lib/selfish":31,"./lib/utils":32,_process:17,"d.js":33,fs:16,superagent:34}],21:[function(t,e,r){function n(t){}var i=t("./selfish").Base;e.exports=i.extend({initialize:function(){this.events={},this.scope=null},on:function(t,e){return t in this.events==!1&&(this.events[t]=[]),this.events[t].push(e),n('Emitter.on("'+t+'")'),this},emit:function(t){if(t in this.events==!1)return this;for(var e=0;e<this.events[t].length;e++)n('Fired event: "'+t+'"'),this.events[t][e].apply(this.scope||this,Array.prototype.slice.call(arguments,1));return this},offAll:function(t){if(t){if(t in this.events==!1)return this;delete this.events[t]}else for(var e in this.events)delete this.events[e];return this},offAt:function(t,e){var r=this.events[t],n=r.slice(e+1);r.length=e,r.push.apply(r,n),this.events[t]=r},off:function(t,e){if(t in this.events==!1)return this;if(!e)return this.offAll(t);for(var r=0;r<this.events[t].length;r++)if(this.events[t][r]==e)return this.offAt(t,r),this;return this}})},{"./selfish":31}],22:[function(t,e,r){function n(t,e){for(var r=[],n=0;n<t.length;n++)r.push(i(t[n],e));return r}function i(t,e){function r(t,e,r){for(var n=""+Math.abs(t),i=t>=0;n.length<e;)n="0"+n;return(i?r?"+":"":"-")+n}var n=t.getFullYear(),i=t.getMonth()+1,o=t.getDate(),s=t.getHours(),a=t.getMinutes(),u=t.getSeconds(),c=t.getTimezoneOffset(),l="";if(i=i<10?"0"+i:i,s=s<10?"0"+s:s,a=a<10?"0"+a:a,u=u<10?"0"+u:u,l=n+"-"+i+"-"+o,e===h.RPOSIX_DATE||e===h.RPOSIX_DATE_VECTOR){var f=s+":"+a+":"+u,p=-c,d="+";p<0&&(p=-p,d="-"),c=d+r(p/60,2)+""+r(p%60,2),l+=" "+f+" "+c}return l}function o(t,e){for(var r=t.value,s=0;s<r.length;s++){var a=r[s];a.type===h.RDATAFRAME?e=o(a,e):(c.isDate(a.type)&&(u.isArray(a.value)?a.value=n(a.value,a.type):a.value=i(a.value,a.type)),a.type=c.deployrToR(a.type),e.value.push(a))}return e}function s(t){for(var e={type:l.DATAFRAME,value:[],name:t.name},r=t.value,s=0;s<r.length;s++){var a=r[s];a.type===h.RDATAFRAME?e=o(a,e):(c.isDate(a.type)&&(u.isArray(a.value)?a.value=n(a.value,a.type):a.value=i(a.value,a.type)),a.type=c.deployrToR(a.type),e.value.push(a))}return e}function a(t){for(var e,r={type:l.LIST,value:[],name:t.name},o=t.value,u=0;u<o.length;u++){var c=o[u];switch(c.type){case h.RDATAFRAME:e=s(c);break;case h.RLIST:e=a(c);break;case h.RNUMERIC_MATRIX:case h.RINTEGER_MATRIX:case h.RBOOLEAN_MATRIX:case h.RSTRING_MATRIX:e={name:c.name,type:l.MATRIX,value:c.value};break;case h.RDATE:case h.RPOSIX_DATE:e={name:c.name,type:l.DATE,format:c.format,value:i(c.value,c.type)};break;case h.RFACTOR:case h.RORDERED:e={name:c.name,type:l.FACTOR,ordered:c.ordered,labels:c.labels,levels:c.levels,value:c.value};break;case h.RSTRING:case h.RBOOLEAN:case h.RNUMERIC:case h.RINTEGER:e={name:c.name,type:l.PRIMITIVE,value:c.value};break;case h.RNUMERIC_VECTOR:case h.RINTEGER_VECTOR:case h.RBOOLEAN_VECTOR:case h.RSTRING_VECTOR:e={name:c.name,type:l.VECTOR,value:c.value};break;case h.RDATE_VECTOR:case h.RPOSIX_DATE_VECTOR:e={name:c.name,type:l.VECTOR,value:n(c.value,c.type),format:c.format};break;default:throw new Error('No RDataType found for "'+c.type+'"')}r.value.push(e)}return r}var u=t("./lang"),c=t("./rtypes"),l=c.r,h=c.deployr;e.exports={encode:function(t){for(var e={},r=0;r<t.length;r++){var o=t[r];switch(o.type){case h.RDATAFRAME:e[o.name]=s(o);break;case h.RLIST:e[o.name]=a(o);break;case h.RNUMERIC_MATRIX:case h.RINTEGER_MATRIX:case h.RBOOLEAN_MATRIX:case h.RSTRING_MATRIX:e[o.name]={type:l.MATRIX,value:o.value};break;case h.RDATE:case h.RPOSIX_DATE:e[o.name]={type:l.DATE,format:o.format,value:i(o.value,o.type)};break;case h.RFACTOR:case h.RORDERED:e[o.name]={type:l.FACTOR,ordered:o.ordered,labels:o.labels,levels:o.levels,value:o.value};break;case h.RSTRING:case h.RBOOLEAN:case h.RNUMERIC:case h.RINTEGER:e[o.name]={type:l.PRIMITIVE,value:o.value};break;case h.RNUMERIC_VECTOR:case h.RINTEGER_VECTOR:case h.RBOOLEAN_VECTOR:case h.RSTRING_VECTOR:e[o.name]={type:l.VECTOR,value:o.value};break;case h.RDATE_VECTOR:case h.RPOSIX_DATE_VECTOR:e[o.name]={type:l.VECTOR,value:n(o.value,o.type),format:o.format};break;default:throw new Error('No RDataType found for "'+o.type+'"')}}return JSON.stringify(e)}}},{"./lang":24,"./rtypes":30}],23:[function(t,e,r){var n="undefined"!=typeof window,i=t("./optional"),o=n?window.WebSocket:i("ws"),s=t("./queue"),a=t("./emitter"),u=t("./selfish").Base,c=t("./utils").merge;e.exports=u.extend(a,{initialize:function(t,e){a.initialize.call(this,{}),this.api=(t||"")+"/deployr/r/event/stream",this.options=e||{},this.ws=null,this.q=new s,this.filter={},this.cookies=this.options.cookies},open:function(t){var e,r=this;return t=this.options=c(t||{},this.options),this.cookies=this.cookies?this.cookies:t.cookies,t.project&&this.project(t.project),t.job&&this.job(t.job),t.managementEventOnly&&this.managementEventOnly(),t.revoEventOnly&&this.revoEventOnly(),t.httpEventOnly&&this.httpEventOnly(),e=this.getRequestURL(),this.q["yield"](!0),this.q.add(function(){var t=this.cookies?{Cookie:this.cookies}:{};this.emit("es:connecting",{url:e,headers:t});var i=n?new o(e):new o(e,"http",{headers:t});i.onopen=function(t){r.emit("es:open",t)};var s="";i.onmessage=function(t){try{if(t.data.split("!|!")[1]){s+=t.data.split("!|!")[1],t=JSON.parse(s),s="";var e=t.deployr.response.event.type;r.emit("es:"+e.replace("Event",""),t)}}catch(n){}},i.onerror=function(t){r.emit("es:error",t)},i.onclose=function(t){r.emit("es:close",t)},this.ws=i},this),t["yield"]||this.flush(),this},close:function(){return this.ws&&this.ws.close(),this},getRequestURL:function(){var t=this.api.replace(/^http/,"ws"),e=this.filter;return t+=e.type?"?"+e.type:"",e.project&&(t+="&"+e.project),e.job&&(t+="&"+e.job),t},getCookies:function(){return this.cookies},destroy:function(){this.emit("destroy"),this.close(),this.offAll(),this.ws=null,this.host=null,this.options=null,this.ws=null,this.q=null,this.filter=null},flush:function(){this.q["yield"](!1),this.q.flush()},share:function(t){return this.cookies=t,this},project:function(t){return this.filter.project="project="+t,this.filter.job=null,this},job:function(t){return this.filter.job="job="+t,this.filter.project=null,this},managementEventOnly:function(){return this.filter={type:"managementEventOnly=true",project:null,job:null},this},httpEventOnly:function(){return this.filter.type="httpEventOnly=true",this},revoEventOnly:function(){return this.filter.type="revoEventOnly=true",this},all:function(){return this.filter={type:null,project:null,job:null},this},session:function(){return this.httpEventOnly()},management:function(){return this.managementEventOnly()}})},{"./emitter":21,"./optional":26,"./queue":27,"./selfish":31,"./utils":32}],24:[function(t,e,r){var n={},i=Object.prototype.toString,o={undefined:"undefined",number:"number","boolean":"boolean",string:"string","[object Function]":"function","[object RegExp]":"regexp","[object Array]":"array","[object Date]":"date","[object Error]":"error"},s=!1;n.isNull=function(t){return null===t},n.isUndefined=function(t){return"undefined"==typeof t},n.isObject=function(t,e){var r=typeof t;return t&&("object"===r||!e&&("function"===r||n.isFunction(t)))||!1},n.isArray=!s&&Array.isArray||function(t){return"array"===n.type(t)},n.isFunction=function(t){return"function"==typeof t},n.isBoolean=function(t){return"boolean"==typeof t},n.isDate=function(t){return"date"===n.type(t)&&"Invalid Date"!==t.toString()&&!isNaN(t)},n.isNumber=function(t){return"number"==typeof t&&isFinite(t)},n.isString=function(t){return"string"==typeof t},n.type=function(t){return o[typeof t]||o[i.call(t)]||(t?"object":"null")},e.exports=n},{}],25:[function(t,e,r){function n(t,e){function r(t){var e="==================================================================================================================\n",r=0;return r=t===s.DEBUG||t===s.ERROR?8:t===s.INFO||t===s.WARN?8:7,{start:e.substring(r),end:e}}if(console){var n,i=Array.prototype.slice.call(t,0),o=e.name,a=e.level===s.ERROR,u=r(e.level);n=e.level===s.WARN&&console.warn?"warn":e.level===s.ERROR&&console.error?"error":e.level===s.INFO&&console.info?"info":"log",i.unshift("["+(a?s.ERROR.name:o)+"] "+u.start),i.push(u.end),console[n](i[0],[i[1]+" ---> "+i[2].call]);for(var c=2;c<i.length;c++)console.log(i[c])}}function i(t,e,r){this.id=t,this.context=e||s.DEBUG}var o,s={},a={};i.prototype={log:function(t,e){t.value>=this.context.value&&n(e,{level:t,name:this.context.name,value:this.context.value})},debug:function(){this.log(s.DEBUG,arguments)},error:function(){this.log(s.ERROR,arguments)},info:function(){this.log(s.INFO,arguments)},warn:function(){this.log(s.WARN,arguments)},setLevel:function(t){t&&"value"in t&&(this.context=t)}},s.DEBUG={value:1,name:"DEBUG"},s.INFO={value:2,name:"INFO"},s.WARN={value:4,name:"WARN"},s.ERROR={value:8,name:"ERROR"},s.OFF={value:99,name:"OFF"},s.setLevel=function(t){o.setLevel(t)},s.debug=function(){o.debug.apply(o,arguments)},s.info=function(){o.info.apply(o,arguments)},s.warn=function(){o.warn.apply(o,arguments)},s.error=function(){o.error.apply(o,arguments)},s.get=function(t,e,r){return a[t]||function(){return a[t]=new i(t,e,r),a[t]}()},o=s.get("global"),e.exports=s},{}],26:[function(t,e,r){e.exports=function(e){try{return t(e)}catch(r){}}},{}],27:[function(t,e,r){function n(){this.emptyCallback=null,this.callbacks=[],this.yielded=!1,this.response=null,this.responseChain=[]}n.prototype={add:function(t,e,r){this.yielded||r?this.callbacks.push({fn:t,ctx:e}):t.apply(e||this,[this.response])},size:function(){return this.callbacks.length},isEmpty:function(){return 0===this.callbacks.length},empty:function(t,e){this.emptyCallback={fn:t,ctx:e}},"yield":function(t){this.yielded=t},take:function(t,e,r){var n;t&&(this.response=t,this.responseChain.push(t)),!this.yielded&&this.callbacks[0]&&(n=this.callbacks.shift(),n.fn.apply(n.ctx||this,[this.responseChain,e,r]),this.callbacks[0]&&this.emptyCallback&&this.emptyCallback.fn.call(this.emptyCallback.ctx||this))},flush:function(t,e,r){for(t&&(this.response=t,this.responseChain.push(t));this.callbacks[0]&&!this.yielded;){var n=this.callbacks.shift();n.fn.apply(n.ctx||this,[this.responseChain,e,r]),this.callbacks[0]&&this.emptyCallback&&this.emptyCallback.fn.call(this.emptyCallback.ctx||this)}}},e.exports=n},{}],28:[function(t,e,r){var n=t("./selfish").Base,i=t("./rtypes");e.exports=n.extend(i,{initialize:function(t,e,r){this.name=t,this.value=e,this.options=r||{}},numeric:function(){return this.value=parseFloat(this.value),this.assert({type:this.deployr.RNUMERIC,name:this.name,value:this.value,toString:this.toString})},integer:function(){return this.value=parseInt(this.value,10),this.assert({type:this.deployr.RINTEGER,name:this.name,value:this.value,toString:this.toString})},logical:function(){return this.assert({type:this.deployr.RBOOLEAN,name:this.name,value:this.value,toString:this.toString})},character:function(){return this.assert({type:this.deployr.RSTRING,name:this.name,value:this.value,toString:this.toString})},date:function(){return this.assert({type:this.deployr.RDATE,name:this.name,value:this.value,format:"yyyy-MM-dd",toString:this.toString})},posixct:function(){return this.assert({type:this.deployr.RPOSIX_DATE,name:this.name,value:this.value,format:"yyyy-MM-dd HH:mm:ss Z",toString:this.toString})},numericVector:function(){return this.assert({type:this.deployr.RNUMERIC_VECTOR,name:this.name,value:this.value,toString:this.toString})},integerVector:function(){return this.assert({type:this.deployr.RINTEGER_VECTOR,name:this.name,value:this.value,toString:this.toString})},logicalVector:function(){return this.assert({type:this.deployr.RBOOLEAN_VECTOR,name:this.name,value:this.value,toString:this.toString})},characterVector:function(){return this.assert({type:this.deployr.RSTRING_VECTOR,name:this.name,value:this.value,toString:this.toString})},dateVector:function(){return this.assert({type:this.deployr.RDATE_VECTOR,name:this.name,value:this.value,format:"yyyy-MM-dd",toString:this.toString})},posixctVector:function(){return this.assert({type:this.deployr.RPOSIX_DATE_VECTOR,name:this.name,value:this.value,format:"yyyy-MM-dd HH:mm:ss Z",toString:this.toString})},list:function(){return this.assert({type:this.deployr.RLIST,name:this.name,value:this.value,toString:this.toString})},dataframe:function(){return this.assert({type:this.deployr.RDATAFRAME,name:this.name,value:this.value,toString:this.toString})},factor:function(){var t=this.options;return this.assert({type:this.deployr.RFACTOR,name:this.name,value:this.value,ordered:!1,levels:t.levels,labels:t.labels,toString:this.toString})},ordered:function(){var t=this.options;return this.assert({type:this.deployr.RORDERED,name:this.name,value:this.value,ordered:!0,levels:t.levels,labels:t.labels,toString:this.toString})},numericMatrix:function(){return this.assert({type:this.deployr.RNUMERIC_MATRIX,name:this.name,value:this.value,toString:this.toString})},integerMatrix:function(){return this.assert({type:this.deployr.RINTEGER_MATRIX,name:this.name,value:this.value,toString:this.toString})},logicalMatrix:function(){return this.assert({type:this.deployr.RBOOLEAN_MATRIX,name:this.name,value:this.value,toString:this.toString})},characterMatrix:function(){return this.assert({type:this.deployr.RSTRING_MATRIX,name:this.name,value:this.value,toString:this.toString})},toString:function(){var t=this.options||{},e=t.levels?"[ levels = "+t.levels+"]":"",r=t.labels?"[ labels = "+t.labels+"]":"";return"[ name = "+this.name+" ] [ value = "+this.value+" ] [ type = "+this.type+" ] "+e+r}})},{"./rtypes":30,"./selfish":31}],29:[function(t,e,r){function n(t,e,r,n){var i;if(s.isObject(e)){if(i=e,!i.type!==t)throw new Error('IllegalArgumentError:Expecting "'+t+'" but found "'+i.type+'"')}else i=a["new"](e,r,n)[t]();return i}var i=t("./selfish").Base,o=t("./rtypes"),s=t("./lang"),a=t("./rinput");e.exports=i.extend(o,{numeric:function(t,e){return this.inputs.push(n(this.deployr.RNUMERIC,t,e)),this},integer:function(t,e){return this.inputs.push(n(this.deployr.RINTEGER,t,e)),this},logical:function(t,e){return this.inputs.push(n(this.deployr.RBOOLEAN,t,e)),this},character:function(t,e){return this.inputs.push(n(this.deployr.RSTRING,t,e)),this},date:function(t,e){return this.inputs.push(n(this.deployr.RDATE,t,e)),this},posixct:function(t,e){return this.inputs.push(n(this.deployr.RPOSIX_DATE,t,e)),this},numericVector:function(t,e){return this.inputs.push(n(this.deployr.RNUMERIC_VECTOR,t,e)),this},integerVector:function(t,e){return this.inputs.push(n(this.deployr.RINTEGER_VECTOR,t,e)),this},logicalVector:function(t,e){return this.inputs.push(n(this.deployr.RBOOLEAN_VECTOR,t,e)),this},characterVector:function(t,e){return this.inputs.push(n(this.deployr.RSTRING_VECTOR,t,e)),this},dateVector:function(t,e){return this.inputs.push(n(this.deployr.RDATE_VECTOR,t,e)),this},posixctVector:function(t,e){return this.inputs.push(n(this.deployr.RPOSIX_DATE_VECTOR,t,e)),this},list:function(t,e){return this.inputs.push(n(this.deployr.RLIST,t,e)),this},dataframe:function(t,e){return this.inputs.push(n(this.deployr.RDATAFRAME,t,e)),this},factor:function(t,e,r,i){var o={levels:r,labels:i};return this.inputs.push(n(this.deployr.RFACTOR,t,e,o)),this},ordered:function(t,e,r,i){var o={levels:r,labels:i};return this.inputs.push(n(this.deployr.RORDERED,t,e,o)),this},numericMatrix:function(t,e){return this.inputs.push(n(this.deployr.RNUMERIC_MATRIX,t,e)),this},integerMatrix:function(t,e){return this.inputs.push(n(this.deployr.RINTEGER_MATRIX,t,e)),this},logicalMatrix:function(t,e){return this.inputs.push(n(this.deployr.RBOOLEAN_MATRIX,t,e)),this},characterMatrix:function(t,e){return this.inputs.push(n(this.deployr.RSTRING_MATRIX,t,e)),this}})},{"./lang":24,"./rinput":28,"./rtypes":30,"./selfish":31}],30:[function(t,e,r){var n=t("./selfish").Base,i=t("./lang"),o={};e.exports=n.extend({r:{PRIMITIVE:"primitive",DATAFRAME:"dataframe",LIST:"list",MATRIX:"matrix",DATE:"date",FACTOR:"factor",VECTOR:"vector"},deployr:{RBOOLEAN:"logical",RNUMERIC:"numeric",RINTEGER:"integer",RSTRING:"character",RDATE:"date",RPOSIX_DATE:"posixct",RBOOLEAN_VECTOR:"logicalVector",RNUMERIC_VECTOR:"numericVector",RINTEGER_VECTOR:"integerVector",RSTRING_VECTOR:"characterVector",RDATE_VECTOR:"dateVector",RPOSIX_DATE_VECTOR:"posixctVector",RLIST:"list",RDATAFRAME:"dataframe",RFACTOR:"factor",RORDERED:"ordered",RBOOLEAN_MATRIX:"logicalMatrix",RNUMERIC_MATRIX:"numericMatrix",RINTEGER_MATRIX:"integerMatrix",RSTRING_MATRIX:"characterMatrix"},isDate:function(t){return t===this.deployr.RDATE||t===this.deployr.RPOSIX_DATE||t===this.deployr.RDATE_VECTOR||t===this.deployr.RPOSIX_DATE_VECTOR||t===this.r.DATE},deployrToR:function(t){var e=this.deployr,r=this.r;return o[t]||(o[e.RBOOLEAN]=r.PRIMITIVE,o[e.RNUMERIC]=r.PRIMITIVE,o[e.RINTEGER]=r.PRIMITIVE,o[e.RSTRING]=r.PRIMITIVE,o[e.RDATE]=r.DATE,o[e.RPOSIX_DATE]=r.DATE,o[e.RBOOLEAN_VECTOR]=r.VECTOR,o[e.RNUMERIC_VECTOR]=r.VECTOR,o[e.RINTEGER_VECTOR]=r.VECTOR,o[e.RSTRING_VECTOR]=r.VECTOR,o[e.RDATE_VECTOR]=r.VECTOR,o[e.RPOSIX_DATE_VECTOR]=r.VECTOR,o[e.RLIST]=r.LIST,o[e.RDATAFRAME]=r.DATAFRAME,o[e.RFACTOR]=r.FACTOR,o[e.RORDERED]=r.FACTOR,o[e.RBOOLEAN_MATRIX]=r.MATRIX,o[e.RNUMERIC_MATRIX]=r.MATRIX,o[e.RINTEGER_MATRIX]=r.MATRIX,o[e.RSTRING_MATRIX]=r.MATRIX),o[t]},assert:function(t){var e,r=this.deployr,n=null,o=t.value;o=i.isArray(o)?o:[o];for(var s=0;s<o.length;s++){var a=o[s];switch(t.type){case r.RNUMERIC:case r.RNUMERIC_VECTOR:case r.RINTEGER:case r.RINTEGER_VECTOR:e=i.isNumber;break;case r.RBOOLEAN:case r.RBOOLEAN_VECTOR:e=i.isBoolean;break;case r.RSTRING:case r.RSTRING_VECTOR:e=i.isString;break;case r.RDATE:case r.RPOSIX_DATE:case r.RDATE_VECTOR:case r.RPOSIX_DATE_VECTOR:e=i.isDate;break;case r.RFACTOR:case r.RORDERED:case r.RDATAFRAME:case r.RINTEGER_MATRIX:case r.RBOOLEAN_MATRIX:case r.RSTRING_MATRIX:e=n}if(e&&!e(a))throw new Error('RInputFormatError: "'+a+'" is not a valid "'+t.type+'" type for input "'+t.name+'"')}return t}})},{"./lang":24,"./selfish":31}],31:[function(e,r,n){!("function"!=typeof t?function(t){t(null,"undefined"!=typeof n?n:window)}:t)(function(t,e){"use strict";e.Base=Object.freeze(Object.create(Object.prototype,{"new":{value:function(){var t=Object.create(this);return t.initialize.apply(t,arguments),t}},initialize:{value:function(){}},merge:{value:function(){var t={};return Array.prototype.forEach.call(arguments,function(e){Object.getOwnPropertyNames(e).forEach(function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)})}),Object.defineProperties(this,t),this}},extend:{value:function(){return Object.freeze(this.merge.apply(Object.create(this),arguments))}}}))})},{}],32:[function(t,e,r){var n=t("./lang"),i=r.get=function(t,e){function r(t,e,n){for(var i in t){var o=e.apply(this,[i,t[i],n]);if(o)return o;t[i]instanceof Object&&!(t[i]instanceof Array)&&r(t[i],e,i)}}function i(t,e){var n={};return r(t,function(t,r,i){return t===e?n=r:null}),n}function o(t){for(var e in t)if(t.hasOwnProperty(e))return t;return n.isObject(t)?null:t}return o(i(t,e))},o=r.inArray=function(t,e,r){var n,i=t.length;for(n=0;n<i;n++)if(r){if(t[n][r]===e)return t[n]}else if(t[n]===e)return t[n];return null};r.merge=function(t,e){t&&"object"==typeof t||(t={}),e&&"object"==typeof e||(e={});for(var r in e)t[r]=e[r];return t},r.workspace=function(t,e){var r=i(t,"workspace");return r?e?o(r.objects,e,"name"):r.objects||r.object:null},r.signature=function(){var t,e=Array.prototype.slice.call(arguments[0],0),r=e.length,i=!1,o={};if(1===r&&n.isObject(e[0]))o=e[0],t=o.project?"/r/project/execute/script":"/r/repository/script/execute";else if(1===r&&n.isString(e[0]))e=e[0].split("/"),t="/r/repository/script/execute",o={author:e[1],directory:e[2],filename:e[3]};else if(2===r){var s=e[1];t=s?"/r/project/execute/script":"/r/repository/script/execute",e=e[0].split("/"),o={project:s,author:e[1],directory:e[2],filename:e[3]}}else r>2&&(o={author:e[2],directory:e[1],filename:e[0]});return o.project&&n.isBoolean(o.project)&&(delete o.project,i=!0),{api:t,opts:o,create:i}}},{"./lang":24}],33:[function(e,r,n){(function(e){!function(n){"use strict";function i(t){d(function(){throw t})}function o(t){return this.then(t,n)}function s(t){return this.then(n,t)}function a(t,e){return this.then(function(e){return y(t)?t.apply(null,m(e)?e:[e]):j.onlyFuncs?e:t},e||n)}function u(t){function e(){t()}return this.then(e,e),this}function c(t){return this.then(function(e){return y(t)?t.apply(null,m(e)?e.splice(0,0,void 0)&&e:[void 0,e]):j.onlyFuncs?e:t},function(e){return t(e)})}function l(t){return this.then(n,t?function(e){throw t(e),e}:i)}function h(t,e){var r=T(t);if(1===r.length&&m(r[0])){if(!r[0].length)return j.fulfilled([]);r=r[0]}var n=[],i=j(),o=r.length;if(o)for(var s=function(t){r[t]=j.promisify(r[t]),r[t].then(function(s){n[t]=e?r[t]:s,--o||i.resolve(n)},function(s){e?(n[t]=r[t],--o||i.resolve(n)):i.reject(s)})},a=0,u=o;a<u;a++)s(a);else i.resolve(n);return i.promise}function f(t,e){return t.then(y(e)?e:function(){return e})}function p(t){var e=T(t);1===e.length&&m(e[0])&&(e=e[0]);for(var r=j(),n=0,i=e.length,o=j.resolved();n<i;n++)o=f(o,e[n]);return r.resolve(o),r.promise}var d,y=function(t){return"function"==typeof t},m=function(t){return Array.isArray?Array.isArray(t):t instanceof Array},v=function(t){return!(!t||!(typeof t).match(/function|object/))},g=function(t){return t===!1||t===n||null===t},T=function(t,e){return[].slice.call(t,e)},R="undefined",k=typeof TypeError===R?Error:TypeError;if(typeof e!==R&&e.nextTick)d=e.nextTick;else if(typeof MessageChannel!==R){var O=new MessageChannel,E=[];O.port1.onmessage=function(){E.length&&E.shift()()},d=function(t){E.push(t),O.port2.postMessage(0)}}else d=function(t){setTimeout(t,0)};var j=function(t){function e(){if(0!==p){var t,e=m,r=0,n=e.length,i=~p?0:1;for(m=[];r<n;r++)(t=e[r][i])&&t(h)}}function r(t){function n(t){return function(e){return o?void 0:(o=!0,t(e))}}var o=!1;if(p)return this;try{var s=v(t)&&t.then;if(y(s)){if(t===T)throw new k("Promise can't resolve itself");return s.call(t,n(r),n(i)),this}}catch(a){return n(i)(a),this}return f(function(){h=t,p=1,e()}),this}function i(t){return p||f(function(){try{throw t}catch(r){h=r}p=-1,e()}),this}var h,f=(n!==t?t:j.alwaysAsync)?d:function(t){t()},p=0,m=[],T={then:function(t,r){var n=j();return m.push([function(e){try{g(t)?n.resolve(e):n.resolve(y(t)?t(e):j.onlyFuncs?e:t)}catch(r){n.reject(r)}},function(t){if((g(r)||!y(r)&&j.onlyFuncs)&&n.reject(t),r)try{n.resolve(y(r)?r(t):r)}catch(e){n.reject(e)}}]),0!==p&&f(e),n.promise},success:o,error:s,otherwise:s,apply:a,spread:a,ensure:u,nodify:c,rethrow:l,isPending:function(){return 0===p},getStatus:function(){return p}};return T.toSource=T.toString=T.valueOf=function(){return h===n?this:h},{promise:T,resolve:r,fulfill:r,reject:i}};if(j.deferred=j.defer=j,j.nextTick=d,j.alwaysAsync=!0,j.onlyFuncs=!0,j.resolved=j.fulfilled=function(t){return j(!0).resolve(t).promise},j.rejected=function(t){return j(!0).reject(t).promise},j.wait=function(t){var e=j();return setTimeout(e.resolve,t||0),e.promise},j.delay=function(t,e){var r=j();return setTimeout(function(){try{r.resolve(y(t)?t.apply(null):t)}catch(e){r.reject(e)}},e||0),r.promise},j.promisify=function(t){return t&&y(t.then)?t:j.resolved(t)},j.all=function(){return h(arguments,!1)},j.resolveAll=function(){return h(arguments,!0)},j.sequence=function(){return p(arguments)},j.nodeCapsule=function(t,e){return e||(e=t,t=void 0),function(){var r=j(),n=T(arguments);n.push(function(t,e){t?r.reject(t):r.resolve(arguments.length>2?T(arguments,1):e)});try{e.apply(t,n)}catch(i){r.reject(i)}return r.promise}},"function"==typeof t&&t.amd)t("D.js",[],function(){return j});else if(typeof r!==R&&r.exports)r.exports=j;else if(typeof window!==R){var b=window.D;j.noConflict=function(){return window.D=b,j},window.D=j}}()}).call(this,e("_process"))},{_process:17}],34:[function(t,e,r){function n(){}function i(t){var e={}.toString.call(t);switch(e){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}function o(){if(v.XMLHttpRequest&&("file:"!=v.location.protocol||!v.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}return!1}function s(t){return t===Object(t)}function a(t){if(!s(t))return t;var e=[];for(var r in t)null!=t[r]&&e.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e.join("&")}function u(t){for(var e,r,n={},i=t.split("&"),o=0,s=i.length;o<s;++o)r=i[o],e=r.split("="),n[decodeURIComponent(e[0])]=decodeURIComponent(e[1]);return n}function c(t){var e,r,n,i,o=t.split(/\r?\n/),s={};o.pop();for(var a=0,u=o.length;a<u;++a)r=o[a],e=r.indexOf(":"),n=r.slice(0,e).toLowerCase(),i=g(r.slice(e+1)),s[n]=i;return s}function l(t){return t.split(/ *; */).shift()}function h(t){return m(t.split(/ *; */),function(t,e){var r=e.split(/ *= */),n=r.shift(),i=r.shift();return n&&i&&(t[n]=i),t},{})}function f(t,e){e=e||{},this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method?this.xhr.responseText:null,this.setStatusProperties(this.xhr.status),this.header=this.headers=c(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this.parseBody(this.text):null}function p(t,e){var r=this;y.call(this),this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){var t=null,e=null;try{e=new f(r)}catch(n){t=new Error("Parser is unable to parse the response"),t.parse=!0,t.original=n}r.callback(t,e)})}function d(t,e){return"function"==typeof e?new p("GET",t).end(e):1==arguments.length?new p("GET",t):new p(t,e)}var y=t("emitter"),m=t("reduce"),v="undefined"==typeof window?this:window,g="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};d.serializeObject=a,d.parseString=u,d.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},d.serialize={"application/x-www-form-urlencoded":a,"application/json":JSON.stringify},d.parse={"application/x-www-form-urlencoded":u,"application/json":JSON.parse},f.prototype.get=function(t){return this.header[t.toLowerCase()]},f.prototype.setHeaderProperties=function(t){var e=this.header["content-type"]||"";this.type=l(e);var r=h(e);for(var n in r)this[n]=r[n]},f.prototype.parseBody=function(t){var e=d.parse[this.type];return e&&t&&t.length?e(t):null},f.prototype.setStatusProperties=function(t){var e=t/100|0;this.status=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.clientError=4==e,this.serverError=5==e,this.error=(4==e||5==e)&&this.toError(),this.accepted=202==t,this.noContent=204==t||1223==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.notFound=404==t,this.forbidden=403==t},f.prototype.toError=function(){var t=this.req,e=t.method,r=t.url,n="cannot "+e+" "+r+" ("+this.status+")",i=new Error(n);return i.status=this.status,i.method=e,i.url=r,i},d.Response=f,y(p.prototype),p.prototype.use=function(t){return t(this),this},p.prototype.timeout=function(t){return this._timeout=t,this},p.prototype.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},p.prototype.abort=function(){if(!this.aborted)return this.aborted=!0,this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this},p.prototype.set=function(t,e){if(s(t)){for(var r in t)this.set(r,t[r]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},p.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},p.prototype.getHeader=function(t){return this._header[t.toLowerCase()]},p.prototype.type=function(t){return this.set("Content-Type",d.types[t]||t),this},p.prototype.accept=function(t){return this.set("Accept",d.types[t]||t),this},p.prototype.auth=function(t,e){var r=btoa(t+":"+e);return this.set("Authorization","Basic "+r),this},p.prototype.query=function(t){return"string"!=typeof t&&(t=a(t)),t&&this._query.push(t),this},p.prototype.field=function(t,e){return this._formData||(this._formData=new FormData),this._formData.append(t,e),this},p.prototype.attach=function(t,e,r){return this._formData||(this._formData=new FormData),this._formData.append(t,e,r),this},p.prototype.send=function(t){var e=s(t),r=this.getHeader("Content-Type");if(e&&s(this._data))for(var n in t)this._data[n]=t[n];else"string"==typeof t?(r||this.type("form"),r=this.getHeader("Content-Type"),"application/x-www-form-urlencoded"==r?this._data=this._data?this._data+"&"+t:t:this._data=(this._data||"")+t):this._data=t;return e?(r||this.type("json"),this):this},p.prototype.callback=function(t,e){var r=this._callback;return this.clearTimeout(),2==r.length?r(t,e):t?this.emit("error",t):void r(e)},p.prototype.crossDomainError=function(){var t=new Error("Origin is not allowed by Access-Control-Allow-Origin");t.crossDomain=!0,this.callback(t)},p.prototype.timeoutError=function(){var t=this._timeout,e=new Error("timeout of "+t+"ms exceeded");e.timeout=t,this.callback(e)},p.prototype.withCredentials=function(){return this._withCredentials=!0,this},p.prototype.end=function(t){var e=this,r=this.xhr=o(),s=this._query.join("&"),a=this._timeout,u=this._formData||this._data;if(this._callback=t||n,r.onreadystatechange=function(){if(4==r.readyState)return 0==r.status?e.aborted?e.timeoutError():e.crossDomainError():void e.emit("end")},r.upload&&(r.upload.onprogress=function(t){t.percent=t.loaded/t.total*100,e.emit("progress",t)}),a&&!this._timer&&(this._timer=setTimeout(function(){e.abort()},a)),s&&(s=d.serializeObject(s),this.url+=~this.url.indexOf("?")?"&"+s:"?"+s),r.open(this.method,this.url,!0),this._withCredentials&&(r.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof u&&!i(u)){var c=d.serialize[this.getHeader("Content-Type")];
c&&(u=c(u))}for(var l in this.header)null!=this.header[l]&&r.setRequestHeader(l,this.header[l]);return this.emit("request",this),r.send(u),this},d.Request=p,d.get=function(t,e,r){var n=d("GET",t);return"function"==typeof e&&(r=e,e=null),e&&n.query(e),r&&n.end(r),n},d.head=function(t,e,r){var n=d("HEAD",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},d.del=function(t,e){var r=d("DELETE",t);return e&&r.end(e),r},d.patch=function(t,e,r){var n=d("PATCH",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},d.post=function(t,e,r){var n=d("POST",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},d.put=function(t,e,r){var n=d("PUT",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},e.exports=d},{emitter:35,reduce:36}],35:[function(t,e,r){function n(t){if(t)return i(t)}function i(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},n.prototype.once=function(t,e){function r(){n.off(t,r),e.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},r.fn=e,this.on(t,r),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks[t];if(!r)return this;if(1==arguments.length)return delete this._callbacks[t],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===e||n.fn===e){r.splice(i,1);break}return this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks[t];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,e)}return this},n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],36:[function(t,e,r){e.exports=function(t,e,r){for(var n=0,i=t.length,o=3==arguments.length?r:t[n++];n<i;)o=e.call(null,o,t[n],++n,t);return o}},{}],37:[function(t,e,r){e.exports=t("./lib/enum")},{"./lib/enum":38}],38:[function(e,r,n){(function(e){!function(t,e,r,n){"use strict";function i(t,e){this.key=t,this.value=e}function o(t,e){function r(){for(var t=0,e=a.enums.length;t<e;t++){var r=a.enums[t];if(0===r.value||r.value&r.value-1)return!1}return!0}if(e&&"string"==typeof e&&(e={name:e}),this._options=e||{},this._options.separator=this._options.separator||" | ",this.enums=[],t.length){var n=t;t={};for(var o=0;o<n.length;o++)t[n[o]]=Math.pow(2,o)}for(var s in t){if(this._options.name&&"name"===s||"_options"===s||"get"===s||"getKey"===s||"getValue"===s||"enums"===s||"isFlaggable"===s)throw new Error('Enum key "'+s+'" is a reserved word!');this[s]=new i(s,t[s]),this.enums.push(this[s])}this._options.name&&(this.name=this._options.name);var a=this;this.isFlaggable=r(),this.freezeEnums()}i.prototype={constructor:i,has:function(t){return t instanceof i||"object"==typeof t&&void 0!==t.key&&void 0!==t.value?0!==(this.value&t.value):"string"==typeof t?this.key.indexOf(t)>=0:0!==(this.value&t)},is:function(t){return t instanceof i||"object"==typeof t&&void 0!==t.key&&void 0!==t.value?this.key===t.key:"string"==typeof t?this.key===t:this.value===t},toString:function(){return this.key},toJSON:function(){return this.key},valueOf:function(){return this.key}},o.prototype={constructor:o,getKey:function(t){var e=this.get(t);return e?e.key:"Undefined"},getValue:function(t){var e=this.get(t);return e?e.value:null},get:function(t){if(null===t||void 0===t)return null;if(t instanceof i||"object"==typeof t&&void 0!==t.key&&void 0!==t.value){var e=this.enums.indexOf(t);return e>=0?t:!this.isFlaggable||this.isFlaggable&&t.key.indexOf(this._options.separator)<0?null:this.get(t.key)}if("string"==typeof t){if(t.indexOf(this._options.separator)>0){for(var r=t.split(this._options.separator),n=0,o=0;o<r.length;o++){var s=r[o];n|=this[s].value}return new i(t,n)}return this[t]}for(var a in this)if(this.hasOwnProperty(a)&&this[a].value===t)return this[a];var u=null;if(this.isFlaggable)for(var c in this)this.hasOwnProperty(c)&&0!==(t&this[c].value)&&(u?u+=this._options.separator:u="",u+=c);return this.get(u||null)},freezeEnums:function(){function t(t){var e=Object.getOwnPropertyNames(t);return e.forEach(function(e){Object.getOwnPropertyDescriptor(t,e).configurable&&Object.defineProperties(t,e,{writable:!1,configurable:!1})}),t}function e(t){return t}function r(n){if("object"==typeof n&&null!==n&&!Object.isFrozen(n)&&!Object.isSealed(n)){for(var i in n)n.hasOwnProperty(i)&&(n.__defineGetter__(i,e.bind(null,n[i])),n.__defineSetter__(i,function(t){throw TypeError("Cannot redefine property; Enum Type is not extensible.")}),r(n[i]));Object.freeze?Object.freeze(n):t(n)}}return r(this),this}},e&&e.exports?e.exports=o:n?n(function(){return o}):t.Enum=o,e&&e.exports&&r&&(o.register=function(t){t=t||"Enum",r[t]||(r[t]=o)})}(this,"undefined"!=typeof r?r:void 0,"undefined"!=typeof e?e:void 0,"undefined"!=typeof t?t:void 0)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],39:[function(t,e,r){!function(t){function r(t,e){if("object"!==i(t))return e;for(var n in e)"object"===i(t[n])&&"object"===i(e[n])?t[n]=r(t[n],e[n]):t[n]=e[n];return t}function n(t,e,n){var s=n[0],a=n.length;(t||"object"!==i(s))&&(s={});for(var u=0;u<a;++u){var c=n[u],l=i(c);if("object"===l)for(var h in c){var f=t?o.clone(c[h]):c[h];e?s[h]=r(s[h],f):s[h]=f}}return s}function i(t){return{}.toString.call(t).slice(8,-1).toLowerCase()}var o=function(t){return n(t===!0,!1,arguments)},s="merge";o.recursive=function(t){return n(t===!0,!0,arguments)},o.clone=function(t){var e,r,n=t,s=i(t);if("array"===s)for(n=[],r=t.length,e=0;e<r;++e)n[e]=o.clone(t[e]);else if("object"===s){n={};for(e in t)n[e]=o.clone(t[e])}return n},t?e.exports=o:window[s]=o}("object"==typeof e&&e&&"object"==typeof e.exports&&e.exports)},{}],40:[function(e,r,n){!("function"!=typeof t?function(t,e){e(null,"undefined"!=typeof n?n:window)}:t)("selfish",function(t,e){"use strict";e.Base=Object.freeze(Object.create(Object.prototype,{"new":{value:function(){var t=Object.create(this);return t.initialize.apply(t,arguments),t}},initialize:{value:function(){}},merge:{value:function(){var t={};return Array.prototype.forEach.call(arguments,function(e){Object.getOwnPropertyNames(e).forEach(function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)})}),Object.defineProperties(this,t),this}},extend:{value:function(){return Object.freeze(this.merge.apply(Object.create(this),arguments))}}}))})},{}],41:[function(t,e,r){var n=t("deployr"),i=t("./lib/task/discreate-task"),o=t("./lib/task/pooled-task"),s=t("./lib/task/background-task"),a=t("./lib/engine/discrete-task-broker"),u=t("./lib/engine/pooled-task-broker"),c=t("./lib/engine/background-task-broker");"undefined"==typeof window||window.deployr||(window.deployr=n),e.exports={deployr:n,RInput:n.RInput,discreteTaskBroker:function(t){return a["new"](t)},pooledTaskBroker:function(t){return u["new"](t)},backgroundTaskBroker:function(t){return c["new"](t)},discreteTask:function(t){return i["new"](t)},pooledTask:function(t){return o["new"](t)},backgroundTask:function(t){return s["new"](t)}}},{"./lib/engine/background-task-broker":1,"./lib/engine/discrete-task-broker":2,"./lib/engine/pooled-task-broker":3,"./lib/task/background-task":7,"./lib/task/discreate-task":8,"./lib/task/pooled-task":9,deployr:20}]},{},[41])(41)});